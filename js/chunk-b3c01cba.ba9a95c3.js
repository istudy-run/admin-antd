(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b3c01cba"],{"10e1":function(e,t,a){"use strict";a.r(t);a("b0c0");var n=function(){var e=this,t=e._self._c;return t("a-card",{attrs:{bordered:!1}},[t("TableTool",{attrs:{"show-alert":!0,dataSource:e.tableData,"table-size":e.tableSize,selectRows:e.selectedRows,selectKeys:e.selectedRowKeys},on:{"update:tableSize":function(t){e.tableSize=t},"update:table-size":function(t){e.tableSize=t},"update:selectRows":function(t){e.selectedRows=t},"update:select-rows":function(t){e.selectedRows=t},"update:selectKeys":function(t){e.selectedRowKeys=t},"update:select-keys":function(t){e.selectedRowKeys=t},refreshTable:e.getRoleList},scopedSlots:e._u([{key:"table",fn:function(){return[t("a-table",{attrs:{tableLayout:"fixed",rowKey:function(e){return e.id},size:e.tableSize,columns:e.columns,dataSource:e.tableData,pagination:e.pagination,loading:{spinning:e.loading,tip:"加载中..."},rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange}},scopedSlots:e._u([{key:"defaultRole",fn:function(a,n){return[t("a-tag",{attrs:{color:"1"===n.defaultRole?"green":"red"}},[e._v(e._s("1"===n.defaultRole?"是":"否")+" ")])]}},{key:"action",fn:function(a,n){return[t("a",{on:{click:function(t){return e.editAuth(n)}}},[t("a-icon",{attrs:{type:"align-left"}}),t("span",{staticClass:"ant-ml-4"},[e._v("菜单权限")])],1),t("a-divider",{attrs:{type:"vertical"}}),t("a",{on:{click:function(t){return e.editRole(n)}}},[t("a-icon",{attrs:{type:"edit"}}),t("span",{staticClass:"ant-ml-4"},[e._v("编辑")])],1),t("a-divider",{attrs:{type:"vertical"}}),t("a",{directives:[{name:"color",rawName:"v-color",value:"red",expression:"'red'"}],on:{click:function(t){return e.deleteRole(n)}}},[t("a-icon",{attrs:{type:"delete"}}),t("span",{staticClass:"ant-ml-4"},[e._v("删除")])],1)]}}])})]},proxy:!0}]),model:{value:e.columns,callback:function(t){e.columns=t},expression:"columns"}},[t("a-button",{attrs:{type:"primary",icon:"plus",ghost:""},on:{click:e.addRole}},[e._v("添加角色")]),t("a-button",{attrs:{type:"danger",icon:"delete",ghost:""},on:{click:e.delRoles}},[e._v("批量删除")])],1),t("a-drawer",{attrs:{width:360,visible:e.drawer.show,title:e.drawer.title,bodyStyle:e.drawer.style},on:{close:function(){return e.drawer.show=!1}}},[t("a-form-model",{ref:"form",attrs:{model:e.roleForm,rules:e.roleFormRules}},[t("a-form-model-item",{attrs:{label:"角色名称"}},[t("a-input",{attrs:{placeholder:"请输入角色名称，必填"},model:{value:e.roleForm.name,callback:function(t){e.$set(e.roleForm,"name",t)},expression:"roleForm.name"}})],1),t("a-form-model-item",{attrs:{label:"角色说明"}},[t("a-textarea",{attrs:{rows:4,placeholder:"请输入说明"},model:{value:e.roleForm.desc,callback:function(t){e.$set(e.roleForm,"desc",t)},expression:"roleForm.desc"}})],1),t("a-form-model-item",{scopedSlots:e._u([{key:"label",fn:function(){return[t("span",[e._v(" 是否默认角色 "),t("a-tooltip",{attrs:{title:"开启后，新注册用户默认拥有该角色",placement:"top"}},[t("a-icon",{attrs:{type:"question-circle"}})],1)],1)]},proxy:!0}])},[t("a-switch",{attrs:{checkedChildren:"是",unCheckedChildren:"否",checked:"1"===e.roleForm.defaultRole},on:{change:function(t){return e.roleForm.defaultRole=t?"1":"0"}}})],1)],1),t("div",{staticClass:"role-drawer-footer"},[t("a-button",{attrs:{type:"primary"}},[e._v("提交")])],1)],1),t("a-modal",{attrs:{title:e.modal.title,keyboard:!1,maskClosable:!1,bodyStyle:e.modalBodyStyle},scopedSlots:e._u([{key:"footer",fn:function(){return[t("a-space",[t("a-button",{attrs:{type:"primary",ghost:""},on:{click:e.handleClickCollapse}},[e._v("全部"+e._s(e.menuCollapse?"收起":"展开"))]),t("a-button",{attrs:{type:"primary",ghost:""},on:{click:e.handleClickSelected}},[e._v("全部"+e._s(e.selectAllMenu?"取消":"选择"))]),t("a-button",{attrs:{type:"primary",loading:e.modalLoading},on:{click:e.handleOkModal}},[e._v("提交")])],1)]},proxy:!0}]),model:{value:e.modal.show,callback:function(t){e.$set(e.modal,"show",t)},expression:"modal.show"}},[t("Tree",{attrs:{treeData:e.treeData,checkable:!0,autoExpandParent:!1,expandedKeys:e.expandedKeys},on:{"update:expandedKeys":function(t){e.expandedKeys=t},"update:expanded-keys":function(t){e.expandedKeys=t},check:e.handleCheckedMenu,expand:e.handleExpandMenu},model:{value:e.checkedMenus,callback:function(t){e.checkedMenus=t},expression:"checkedMenus"}})],1)],1)},o=[],l=a("2909"),i=a("b85c"),s=a("5530"),r=(a("c119"),a("d865")),c=(a("d3b7"),a("159b"),a("a15b"),a("d81d"),a("4de4"),a("235e")),d=[],u=function e(t){return t.forEach((function(t){if(!d.some((function(e){return e.key===t.key}))){var a={key:t.path,title:t.title,path:t.path,openWay:"0",divider:"0",icon:t.icon,children:t.children};d.push(a)}t.children.length&&e(t.children)})),d},h={name:"Role",components:{Tree:r["a"]},data:function(){return{loading:!1,modalLoading:!1,columns:[{title:"序号",dataIndex:"index",align:"center",customRender:function(e,t,a){return a+1},width:60},{title:"角色名称",dataIndex:"name",width:180},{title:"说明",dataIndex:"desc"},{title:"创建时间",dataIndex:"createTime",width:180},{title:"更新时间",dataIndex:"updateTime",width:180},{title:"是否默认角色",dataIndex:"defaultRole",scopedSlots:{customRender:"defaultRole"},align:"center",width:140},{title:"操作",dataIndex:"action",scopedSlots:{customRender:"action"},align:"center",fixed:"right",width:240}],tableData:[],tableSize:"middle",pagination:{total:0,current:1,pageSize:10,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(e){return"共".concat(e,"条")}},drawer:{show:!1,title:"",style:{height:"calc(100% - 55px)",overflow:"auto",paddingBottom:"53px",position:"static"}},modal:{show:!1,title:""},roleForm:{},roleFormRules:{},selectedRows:[],selectedRowKeys:[],treeData:[],expandedKeys:[],checkedMenus:[],menuCollapse:!1,selectAllMenu:!1}},computed:{modalBodyStyle:function(){return{height:"".concat(document.body.clientHeight-400,"px"),overflow:"auto"}}},created:function(){this.getRoleList()},methods:{getRoleList:function(){var e=this;this.loading=!0,setTimeout((function(){e.tableData=[{id:2000000001,name:"ROLE_USER",desc:"普通用户",createTime:"2020-01-01 12:01:25",updateTime:"2020-01-02 13:10:33",defaultRole:"1"},{id:2000000002,name:"ROLE_OP",desc:"运营用户",createTime:"2020-01-02 08:12:43",updateTime:"2020-01-04 22:12:28",defaultRole:"0"},{id:2000000003,name:"ROLE_ADMIN",desc:"管理员用户",createTime:"2020-01-03 12:44:19",updateTime:"2020-01-06 14:02:22",defaultRole:"0"}],e.loading=!1}),500)},addRole:function(){this.roleForm={defaultRole:"0"},this.drawer=Object(s["a"])(Object(s["a"])({},this.drawer),{},{title:"添加角色",show:!0})},delRoles:function(){var e=this,t=this.$createElement;this.selectedRows.length?this.$confirm({title:"删除确认",okType:"danger",content:t("span",["您确认要删除角色 ",t("strong",[this.selectedRows.map((function(e){return e.name})).join("，")])," ？"]),loading:!0,onOk:function(){return new Promise((function(t){setTimeout((function(){e.$message.error("抱歉，您没有该权限"),t()}),800)}))}}):this.$message.error("您没有选择角色")},editAuth:function(e){this.modal=Object(s["a"])(Object(s["a"])({},this.modal),{},{title:"分配 ".concat(e.name," 的菜单权限"),show:!0});var t=Object(c["a"])(this.$store.state.permission.addRouters);this.treeData=[],this.formatMenus(this.treeData,t),this.checkedMenus=[],this.expandedKeys=[this.treeData[0].key]},formatMenus:function(e,t){var a,n=Object(i["a"])(t);try{for(n.s();!(a=n.n()).done;){var o,l,s=a.value,r={key:s.path,path:s.path,title:null===s||void 0===s||null===(o=s.meta)||void 0===o?void 0:o.title,openWay:"0",divider:"0",icon:null===s||void 0===s||null===(l=s.meta)||void 0===l?void 0:l.icon,children:[]};s.children&&this.formatMenus(r.children,s.children),e.push(r)}}catch(c){n.e(c)}finally{n.f()}},editRole:function(e){this.roleForm=e,this.drawer=Object(s["a"])(Object(s["a"])({},this.drawer),{},{title:"编辑角色",show:!0})},deleteRole:function(e){var t=this,a=this.$createElement;this.$confirm({title:"删除确认",okType:"danger",content:a("span",["您确认要删除角色 ",a("strong",[e.name])," ？"]),loading:!0,onOk:function(){return new Promise((function(e){setTimeout((function(){t.$message.error("抱歉，您没有该权限"),e()}),800)}))}})},handleCheckedMenu:function(e,t){this.checkedMenus=Object(l["a"])(e)},handleExpandMenu:function(e){this.expandedKeys=e},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},handleClickCollapse:function(){this.menuCollapse=!this.menuCollapse,this.menuCollapse?this.expandedKeys=u(this.treeData).filter((function(e){return e.children.length})).map((function(e){return e.key})):this.expandedKeys=[]},handleClickSelected:function(){this.selectAllMenu=!this.selectAllMenu,this.selectAllMenu?this.checkedMenus=u(this.treeData).map((function(e){return e.key})):this.checkedMenus=[]},handleOkModal:function(){var e=this;this.modalLoading=!0,setTimeout((function(){e.modalLoading=!1,e.modal.show=!1}),800)}}},m=h,p=(a("d1f4"),a("2877")),f=Object(p["a"])(m,n,o,!1,null,"5bb8a32e",null);t["default"]=f.exports},"928da":function(e,t,a){},d1f4:function(e,t,a){"use strict";a("928da")}}]);