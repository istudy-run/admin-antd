(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-aa934532"],{b789:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a("b775"),s={sectionList:"/section/list"};function o(){return Object(n["b"])({url:s.sectionList,method:"get"})}},e8ab:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("a-card",{attrs:{bordered:!1}},[t("a-alert",{staticClass:"ant-mb-16",attrs:{description:"左侧为$xlsx插件自定义导出，右侧为TableTool组件使用$table导出（基于$xlsx封装，只需传入columns和data即可）。",type:"info","show-icon":""}}),t("TableTool",{attrs:{dataSource:e.tableData,tools:["export"],selectRows:e.selectedRows,"export-file-name":"导出数据"},model:{value:e.columns,callback:function(t){e.columns=t},expression:"columns"}},[t("a-button",{attrs:{type:"dashed",icon:"download"},on:{click:function(t){return e.handleClick(!0)}}},[e._v("导出勾选")]),t("a-button",{attrs:{type:"dashed",icon:"download"},on:{click:function(t){return e.handleClick(!1)}}},[e._v("导出全部")])],1),t("a-table",{attrs:{size:"middle",tableLayout:"fixed",rowKey:function(e){return e.title},columns:e.columns,pagination:!1,dataSource:e.tableData,rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange}}})],1)},s=[],o=(a("d81d"),a("b789")),l={name:"FileExcel",data:function(){return{pageMeta:{description:"使用内置<code>$xlsx</code>插件，可以很方便的导出列表数据。<code>$table</code>在此基础封装了针对Table组件更方便的导入导出操作，仅需一行代码。"},selectedRowKeys:[],selectedRows:[],columns:[{title:"序号",align:"center",dataIndex:"index",customRender:function(e,t,a){return a+1},width:60},{title:"标题",dataIndex:"title",width:120},{title:"作者",dataIndex:"author",width:120},{title:"段落",dataIndex:"section"}],tableData:[]}},created:function(){var e=this;Object(o["a"])().then((function(t){return e.tableData=t.result||[]}))},methods:{onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},handleClick:function(e){if(!e||this.selectedRows.length)if(this.tableData.length){var t={header:this.columns.map((function(e){return e.title})),fields:this.columns.map((function(e){return e.dataIndex})),data:e&&this.selectedRows||this.tableData,fileName:"导出数据"};this.$xlsx.array2Excel(t);var a=e&&"".concat(this.selectedRows.length,"项数据导出成功")||"数据导出成功";this.$message.success(a)}else this.$message.error("数据不能为空");else this.$message.error("请勾选行数据")}}},c=l,i=a("2877"),r=Object(i["a"])(c,n,s,!1,null,null,null);t["default"]=r.exports}}]);